# Sample Info

| SHA256|
|---------------------------------------------------------------------------------|
|5c65955da2b6e996c378858d6a886bad85e969fd42509053794cb8ad64630894 |

* Size:  356.650 bytes
* First seen:  2024-05-11 07:06:46 UTC
* File Type:  .js

# Analysis
I found the sample on malware bazaar and wanted to take a look at jscript malware after a long while

# Stage 1
After running it through an deobfuscator to make it more readable, I can finally start analysing.
The first part defines some functions vital for decrypting the second stage. This is done using JavaScript's "String.prototype".


![image](https://github.com/vrrmin/re-stuff/assets/97342354/1cf3a6c8-334a-4795-9a0d-d792e4991ec2)

* function xX7r0lQ() => this function resolves a string using a "key", which is then stored in the variable (function) "PRNT_LN". Instead of taking inputs, this function uses "this" to access the "key". The "key" is a sequence of numbers in string-form.
* function load(cont, str, nid) => load() has two purposes: first, it is used to store the result of xX7r0lQ's results in "PRNT_LN"

As mentioned, the main decrypt function uses a sequence of numbers to resolve a full string by taking a substring according to the numbers. Line 46 visualizes this. 
This lines writes "prototype" in the variable "PRNT_LN", which is used below to define the void function "h5aLFnU"
