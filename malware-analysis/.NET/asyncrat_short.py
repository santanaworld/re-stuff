from hashlib import pbkdf2_hmac
from Crypto.Cipher import AES
import base64


config_b64 = {
    "Ports": "dFf126wYgCb+z/i44U8gBCFMTbY3PZGrOUn5FHMsx+Dt4revWUDbY2uTHi8Adw9KUZD+bZWTp5WfU1dGhMR4rg==",
    "Hosts": "/IjSTxAoXEwHFwMyIyDJzNq/Ezvghhl91HD6vZHmtIzEHBOWOXCz6xkRiIG1eF4z/LtFu23Jpa0QIJ1Sf+Ax0hxjVI45V40Z5ERnm3EIUfs=",
    "Version": "BDx+Iqs5AAPVOV/3/3Q3FmZbF6az/V0sle2KIeMnEyrOmf0sOu/HeWwwLwVuUe48RZTaAwckMCxSI9Rr4YYqSQ==",
    "Install": "NzkoLGAd20B2wXfQzAKwlaOLNPCzneCrBftsGZdPDLaYelbMv031cBcxd14pMOnvV95C1m4v/fgxOfjpRMmGGw==",
    "Mutex": "TbqlEMt6xp6EvJSLjoVPacxdEUptA0/IPDWIfUFw+GnaC2jpi2mS1WiMlA6JFCgjtVkc31bMGU2WPDAIYQ03zw==",
    "Anti": "Plb0n43ZfBgoATXvFasPWzCe/qpWQlDVS3WiSqSF7BcxkSdaIDFj+N0c39kriaMWfVGZht2J5j76yQWAMP0R2Q==",
    "Pastebin": "WYielA5EPy+ENvVfTl39vkuykxCuYTfE2wrLRHFgtq3DOSPQIQBVxdONamdr7Bt4ZLDAhnsYHZ51Bhpo317tvA==",
    "BDOS": "AtKcYIP5o2tmLNSngsOpGyYGAiD3Y2IqTe+wRfiA8hLEpQfG0pL0z1Lvx7mbf7gXkCHJt42JV2uDORyfyj1mHA==",
    "Group": "vPZhwp+GIzTgxRJZLlD3Q0Y+p12aM99reTOBWPGPYnIUSQ5lRZIw8+LOYFFI+QzucKBIdCcSV0fUrAcuCySfXw==",
    "Signature": "MpGamIIT8S0/ugO62ZLVZ2k/q/04Nez649CEibF88AJwWcFzjqxqveHd6jw/B0LKic3dSndBegRLkk8Be2aL5nVb0d10iX1keppwn6lC/ohVLnUkgqqAF/em5PaYMoRr+neIZG4+DiYhUFL8x9MH1nW9rxkOqI4lvRqWR5AMukx0/D7g/+lsnmxyeNOqBPkZ3ks/TqwSjgn63FIQgYJylR3Fa7ED4zFW99KDUuEjFw0qPz1R7acI046HyTjl4aUiFhkfukCznq2p/2F42Tx+wbRfMirQj4AIcgJora7ODTBe4J1rVtpWsn07+cLvtBTfBdA4gmexUw2lnSPe2qadbnNX/8xcn2CCBSIqc4OPWMOyAHVEY6RJ2OpsBbOicmbaZlbT5J0LF8xX1oG3rL6Tk+Lu22GpKe2vTJw2loXKJ6pGavU/d8eqH3zqF2Mi1/sdxcPrJISgsDMm9/rVNOUTghTNXbBZEabvWisCH8vErog1xFXFIejPRl9S0KMtQTkEWIGkPNAjXcE+07+XsL85FMzk6hN1diUYVhoL3g+PZo0Sk8mGjn5snI81EqZBkjP3hQbrK/GEducBTtyNPp3dgQwmFEhRQGhUHMMqeFPLURn4rIzlq54YiMyCf8rh84vPfrOG9hQftosAzYF7a6TIzPbIXlTW47/th4J4lp6H/MKT3gW/ifZ16hAuBuFqzOOPNF9Hih1O5qXyTCjj1+/2gDPwx5ctDFWLdCrileQqKoC7IUyIPnFckdIwpGUEAbmDoT01Sh2Pxtfio4i2DsjQ+hQLRRxCJWjazZILHYGCxSbW+LuM/K0hXf4PVlX+xT3/6LCDgZKMK1OwGjuJyikDtfxEGS4i8GcV038SQVngj7NGoM+Psu9UKd0NA3ao1YLoBbm5JEMgFL8ncNhsA7DtNvEieaE1OCnSlpbnmlRHE441nfn0vPsVmjLiaDa64wAZM69eVXE5mtHxAF0xyEsqQQ==",
    "Certificate": "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",
    
}

salt=[191, 235, 30, 86, 251, 205, 151, 59, 178, 25, 2, 36, 48, 165, 120, 67, 0, 61, 86, 68,210, 30, 98, 185, 212, 241, 128, 231, 230, 195,57, 65]


saltHex = bytearray(salt)

#key = b64decode("SHNUTU5pdURCTEJXcktBMGkwVVVmZzdxdHJGYmVUd3I=")
key = b"HsTMNiuDBLBWrKA0i0UUfg7qtrFbeTwr"
#verify = in[:32]
#IV = in[32:48]
#msg = in[48:]
hmac_key = pbkdf2_hmac("sha1", key, saltHex, 50000, 32)


for name, string in config_b64.items():

    encrypted_str = base64.b64decode(string)

    iv = encrypted_str[32:48]
    cipher = AES.new(hmac_key, AES.MODE_CBC, iv)
    decryptedtext = cipher.decrypt(encrypted_str[48:])
    decryptedtext = decryptedtext.rstrip(b'\0').decode("UTF-8")
    print(name + ": " + decryptedtext)